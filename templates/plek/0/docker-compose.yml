version: '2'
services:
  plek:
    image: ilumy/plek:v6
    ports:
    - '1337:1337'
    environment:
      - NODE_ENV=production-docker
      - certificate=${certificate}
    command: npm start
    links:
      - mongo
      - redis
      - elasticsearch
  mongo:
    image: mongo
    ports:
    - '27018:27017'
    volumes_from:
    - mongodata
  mongodata:
    image: tianon/true
    volumes:
    - /data/db
  redis:
    image: redis
    ports:
        - "6379"
  elasticsearch:
    image: elasticsearch
    ports:
      - "9200:9200"
    environment:
      ES_JAVA_OPTS: "-Xms1g -Xmx1g"
